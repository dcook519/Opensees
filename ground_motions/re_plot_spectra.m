clear
close
clc

period = [0.02	0.03	0.04	0.05	0.06	0.07	0.08	0.09	0.1	0.11	0.12	0.13	0.14	0.15	0.16	0.17	0.18	0.19	0.2	0.21	0.22	0.23	0.24	0.25	0.26	0.27	0.28	0.29	0.3	0.31	0.32	0.33	0.34	0.35	0.36	0.37	0.38	0.39	0.4	0.41	0.42	0.43	0.44	0.45	0.46	0.47	0.48	0.49	0.5	0.51	0.52	0.53	0.54	0.55	0.56	0.57	0.58	0.59	0.6	0.61	0.62	0.63	0.64	0.65	0.66	0.67	0.68	0.69	0.7	0.71	0.72	0.73	0.74	0.75	0.76	0.77	0.78	0.79	0.8	0.81	0.82	0.83	0.84	0.85	0.86	0.87	0.88	0.89	0.9	0.91	0.92	0.93	0.94	0.95	0.96	0.97	0.98	0.99	1	1.02	1.04	1.06	1.08	1.1	1.12	1.14	1.16	1.18	1.2	1.22	1.24	1.26	1.28	1.3	1.32	1.34	1.36	1.38	1.4	1.42	1.44	1.46	1.48	1.5	1.52	1.54	1.56	1.58	1.6	1.62	1.64	1.66	1.68	1.7	1.72	1.74	1.76	1.78	1.8	1.82	1.84	1.86	1.88	1.9	1.92	1.94	1.96	1.98	2	2.05	2.1	2.15	2.2	2.25	2.3	2.35	2.4	2.45	2.5	2.55	2.6	2.65	2.7	2.75	2.8	2.85	2.9	2.95	3	3.1	3.2	3.3	3.4	3.5	3.6	3.7	3.8	3.9	4	4.1	4.2	4.3	4.4	4.5	4.6	4.7	4.8	4.9	5];
ew = [0.453964306	0.454808084	0.45296605	0.453221195	0.455747083	0.459329623	0.459550199	0.475424103	0.494995204	0.506015971	0.513868141	0.542633521	0.51638644	0.522000071	0.597551511	0.566651214	0.594727772	0.634440023	0.662965896	0.78320716	0.816467213	0.781208589	0.832204796	0.877723417	0.94186547	1.011984303	1.064941592	1.074430889	1.190990406	1.30957191	1.369745927	1.332943186	1.232386162	1.103498006	0.973062727	0.924880613	0.897140148	0.936894279	0.937069547	0.906697873	0.961713749	0.991536534	0.975120098	0.927232088	0.87474966	0.833720619	0.801511723	0.836157869	0.868596791	0.880167503	0.879262653	0.869397315	0.846340905	0.806124012	0.767526793	0.723830132	0.682299723	0.645543312	0.637506471	0.653310452	0.675163851	0.696431049	0.713394488	0.723642964	0.727039428	0.725253167	0.721815935	0.731403748	0.766076296	0.793025882	0.810388403	0.815516596	0.806892414	0.781650669	0.74053509	0.710845164	0.738683941	0.764740405	0.788813646	0.810766016	0.830532961	0.848128138	0.863625279	0.877132909	0.888776662	0.898692808	0.907026152	0.913922381	0.919512553	0.923899823	0.927342976	0.929950236	0.931557912	0.93220625	0.931931785	0.930765412	0.928736633	0.926169767	0.923058424	0.914611802	0.903650522	0.909144889	0.921921457	0.933692775	0.944763559	0.955384308	0.965262835	0.973667759	0.980986347	0.986245043	1.068922141	1.169810692	1.262115268	1.344233957	1.448577693	1.547957228	1.632385756	1.701550331	1.753999118	1.789699172	1.810109193	1.815823074	1.809228732	1.791389373	1.763943147	1.729239634	1.688616715	1.693861175	1.691064087	1.675234124	1.647741746	1.610534833	1.564832861	1.511844513	1.453523826	1.39024965	1.323345002	1.254006108	1.183170444	1.111512142	1.040074704	0.969239716	0.89995335	0.832904444	0.768752429	0.707940141	0.654931226	0.618782038	0.606669562	0.577684474	0.550151983	0.523449313	0.497149835	0.472893772	0.468047488	0.46318464	0.458035443	0.45244436	0.446304142	0.43960693	0.432301854	0.424352509	0.415789791	0.406686172	0.414394181	0.419689359	0.421187446	0.419315746	0.414466863	0.396866726	0.370592986	0.358964088	0.357312469	0.349218844	0.336090404	0.319218288	0.299753509	0.278613473	0.256539384	0.233980103	0.211353675	0.189528581	0.172975632	0.171857849	0.169661916	0.16648886	0.162435506	0.157617575	0.152164185];
ns = [0.563145536	0.563715507	0.562901048	0.566989986	0.5708139	0.585119459	0.583182878	0.608040404	0.855256401	0.770293292	0.997370121	1.186385218	1.153847396	1.107729425	0.957651204	1.119936755	1.208686736	1.210343921	1.196331296	1.056589813	1.136385634	1.210428429	1.259273451	1.236471508	1.124081734	1.074633156	1.058566448	1.05426064	1.044842729	1.180468186	1.211724139	1.276570266	1.303965715	1.274509107	1.214700808	1.149534094	1.163414646	1.235971811	1.278803702	1.274395092	1.344295971	1.451307914	1.597234964	1.68829271	1.807968411	1.898066622	2.036689965	2.171222269	2.265509694	2.304034108	2.277026237	2.206656965	2.120306228	2.057522865	2.045911741	2.097020375	2.191787471	2.306393032	2.409096094	2.479337253	2.513610755	2.507350369	2.465456985	2.399023216	2.315084541	2.271219835	2.227221625	2.176403527	2.117753732	2.056206923	1.983706804	1.904512108	1.812342195	1.706946198	1.626737649	1.559976588	1.479627041	1.392839989	1.303256674	1.218338104	1.146458941	1.092018125	1.059131661	1.048272012	1.056317403	1.077816849	1.107725524	1.137665505	1.165454535	1.185631586	1.196052674	1.195367408	1.182979644	1.158982808	1.124168617	1.0802185	1.027901943	0.968985904	0.905410862	0.840701346	0.821009019	0.798669355	0.774485747	0.749208306	0.723479303	0.711679654	0.734440758	0.746507269	0.788492309	0.824434551	0.846107131	0.855303358	0.852649625	0.838585069	0.813882702	0.804646375	0.793079289	0.773645577	0.746773811	0.713104619	0.673948758	0.630427202	0.583519975	0.534214223	0.502214777	0.477300183	0.456713787	0.445687455	0.433852077	0.421315379	0.408174906	0.394824664	0.381039135	0.366863267	0.352618975	0.338197024	0.32357142	0.309119848	0.294513378	0.280121431	0.26572499	0.251584292	0.247871211	0.244515094	0.241203068	0.239192414	0.247861021	0.255119487	0.260973036	0.269734383	0.271018646	0.264547247	0.250803122	0.231982664	0.215176748	0.206880498	0.198439889	0.185461625	0.169269609	0.162381028	0.15748544	0.152750896	0.148097911	0.143532708	0.139130814	0.134804393	0.130555602	0.12643485	0.122411982	0.114603838	0.107211837	0.100141341	0.093453064	0.087077468	0.081066218	0.082818536	0.0829538	0.081254199	0.078445264	0.074840032	0.070549578	0.067060616	0.067866658	0.067845039	0.067109466	0.065779032	0.063965701	0.06178038	0.059316451];
% vert = [0.17735037	0.178667309	0.176642467	0.185974134	0.207728759	0.265556527	0.336485259	0.289333727	0.410877309	0.485450515	0.531865066	0.353413543	0.370551406	0.304376192	0.247309091	0.2777984	0.267411425	0.225060851	0.200886624	0.203095974	0.225085154	0.243654073	0.236385629	0.240642019	0.209566693	0.231708737	0.273352275	0.253878827	0.197715631	0.166346339	0.154557706	0.141352679	0.157408923	0.160293046	0.154695091	0.153147088	0.160615153	0.162852314	0.156236943	0.146630006	0.145092177	0.146048849	0.154550183	0.16741799	0.174356279	0.172161531	0.161363371	0.164120855	0.163157156	0.156140256	0.145404804	0.145429196	0.151153505	0.155804321	0.158459801	0.157778821	0.15392109	0.148422069	0.142457112	0.136103902	0.12920172	0.121956652	0.114427183	0.10627437	0.097233584	0.091199302	0.089105552	0.088955457	0.091440011	0.096010772	0.102030669	0.108405675	0.114538374	0.119722815	0.124080502	0.12715514	0.129427218	0.130647473	0.131478255	0.131619367	0.13165981	0.131284974	0.130843289	0.130031397	0.129130373	0.132205009	0.136837084	0.140909709	0.144189298	0.146604429	0.148345376	0.149190919	0.149215164	0.148546416	0.147306155	0.145594376	0.143547618	0.141108134	0.13827598	0.131311145	0.123237948	0.114618717	0.106648839	0.099792143	0.093834305	0.08927878	0.086425366	0.085456074	0.086325654	0.08876972	0.09235179	0.096705003	0.101359985	0.106111112	0.11091699	0.115667518	0.119953711	0.123642806	0.12679156	0.129313925	0.131203981	0.13259264	0.133562561	0.133965889	0.133708612	0.132943137	0.131596082	0.129867305	0.128162076	0.127438506	0.126646125	0.125781128	0.124786597	0.123619642	0.122239696	0.120586474	0.118680687	0.11670627	0.114800222	0.112908982	0.110913983	0.108805458	0.106619057	0.104508844	0.10237538	0.100257656	0.098259702	0.096364275	0.094519439	0.089663277	0.084860398	0.080149296	0.075732084	0.071238007	0.066649886	0.062515524	0.058979676	0.055530093	0.052144297	0.04891252	0.045868362	0.043754611	0.042490167	0.041159866	0.043043291	0.045265557	0.051112239	0.056386484	0.061257884	0.065058553	0.062134234	0.055551641	0.048346457	0.042592852	0.038843693	0.03823373	0.038179474	0.037457499	0.038280743	0.039531669	0.042357545	0.044467612	0.045299273	0.044958495	0.043922241	0.043528255	0.042368579	0.040559697	0.038944831];

hold on
plot(period,ew,'LineWidth',1.5,'DisplayName','East-West')
plot(period,ns,'LineWidth',1.5,'DisplayName','North-South')
% plot(period,vert,'LineWidth',1.5,'DisplayName','Vertical')
xlabel('Period (s)')
ylabel('Sa of roof at 5% damping (g)')
grid on
box on 
legend('Location','northeast')
set(gca,'FontSize',15)
xlim([0,3])
savefig('Roof Spectra.fig')
saveas(gcf,'Roof Spectra.png')
hold off
close

dir1 = fileread('C:\Users\Dustin\Desktop\Repos\Opensees\ground_motions\ICSB_recordings\chan_13_accel\chan_13_accel.txt');
data_raw_1 = str2double(strsplit(dir1,' '));
data_1 = data_raw_1(~isnan(data_raw_1));
plot(linspace(0,5810*0.01,5810),[0,data_1(3:end)],'LineWidth',1.5)
pga_dir1 = max(abs(data_1(3:end)))

figure
dir1_alt = fileread('C:\Users\Dustin\Desktop\Repos\Opensees\ground_motions\ICSB_1979\gm_ew.tcl');
data_raw_1_alt = str2double(strsplit(dir1_alt,' '));
data_1_alt = data_raw_1_alt(~isnan(data_raw_1_alt));
pga_dir1_FF = max(abs(data_1_alt))
hold on
plot(linspace(0,5810*0.01,5810),[0,data_1(3:end)],'LineWidth',1.5)
plot(linspace(0,5689*0.01,5689),[0,data_1_alt],'LineWidth',1.5)
hold off

figure
dir2 = fileread('C:\Users\Dustin\Desktop\Repos\Opensees\ground_motions\ICSB_recordings\chan_11_accel\chan_11_accel.txt');
data_raw_2 = str2double(strsplit(dir2,' '));
data_2 = data_raw_2(~isnan(data_raw_2));
plot(linspace(0,5809*0.01,5809),[0,data_2(3:end)],'LineWidth',1.5)
pga_dir1 = max(abs(data_2(3:end)))

figure
dir3 = fileread('C:\Users\Dustin\Desktop\Repos\Opensees\ground_motions\ICSB_recordings\chan_12_accel\chan_12_accel.txt');
data_raw_3 = str2double(strsplit(dir3,' '));
data_3 = data_raw_3(~isnan(data_raw_3));
plot(linspace(0,5809*0.01,5809),[0,data_3(3:end)],'LineWidth',1.5)
pga_dir1 = max(abs(data_3(3:end)))